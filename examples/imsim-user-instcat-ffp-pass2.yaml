# Use imSim custom modules
modules:
    - imsim

# Get most of the configuration from the imSim config-template
# for instance catalogs.
template: imsim-config-instcat

################################################################
#  Make your changes below.
################################################################

# Put your own commands that override the defaults below here.  For example
# input.instance_catalog.file_name: ./imsim_cat_197356.txt
# input.instance_catalog.sort_mag: False
# input.tree_rings.only_dets: [R22_S11]
# image.nobjects: 5

input.checkpoint: ""
# input.instance_catalog: ""
input.instance_catalog.file_name: $os.environ.get('IMSIM_HOME')+'/imSim/examples/example_instance_catalog_ffp.txt'
input.instance_catalog.sort_mag: False
# input.opsim_data: ""

input.tree_rings: ""
input.atm_psf: ""

input.initial_image:
    dir: output
    file_name:
        type: FormattedStr
        format : eimage_%08d-%1d-%s-%s-det%03d.fits
        items:
            - { type: OpsimData, field: observationId }
            - { type: OpsimData, field: snap }
            - $band
            - $det_name
            - "@output.det_num"

# Simple off detector photon input reading one file.
# input.off_detector_photons:
#     file_name: "output/off_det_00398414-0-r-R22_S11-det094.fits"
#     camera: $camera
#     det_name: $det_name

# If we're doing the preprocessing step then we've already reorganised the
# photons so they live in one file per destination detector, so we only need to
# read that one. But, we might feasibly also wish to directly specify a list of
# off-detector photon files, which presumably haven't been preprocessed, so I
# might want to add the capability to work from a file list too.
input.off_detector_photons:
    dir: output
    file_name:
        type: FormattedStr
        format : off_det_%08d-%1d-%s-%s-det%03d.fits
        items:
            - { type: OpsimData, field: observationId }
            - { type: OpsimData, field: snap }
            - $band
            - $det_name
            - "@output.det_num"
    camera: $camera
    det_name: $det_name

psf:
    type: Convolve
    items:
        -
           type: Gaussian
           fwhm: 0.3

stamp: ""

image.type: LSST_FocalPlaneImage
image.sensor.treering_center: ""
image.sensor.treering_func: ""

output.det_num.first: 95
output.nfiles: 1
output.file_name.format: "eimage_full_focal_%08d-%1d-%s-%s-det%03d.fits"

output.dir: output
